# FitLog - 빌드 및 테스트 가이드

안드로이드 앱 개발이 처음인 분들을 위한 상세 가이드입니다.

> **최종 수정일:** 2026-01-30
> **빌드 상태:** ✅ 정상 (assembleDebug 성공)

---

## 1. 사전 준비 (한 번만 하면 됨)

### 1.1 환경 변수 확인

PowerShell을 열고 다음 명령어로 설치 상태를 확인합니다:

```powershell
# JDK 확인
java -version
# 결과 예시: openjdk version "17.x.x"

# Android SDK 확인
echo $env:ANDROID_HOME
# 결과 예시: D:\Android
```

만약 명령어가 작동하지 않으면 [00_환경_설정.md](00_환경_설정.md)를 참고하여 환경 변수를 설정하세요.

### 1.2 스마트폰 개발자 옵션 활성화

**한 번만 설정하면 됩니다:**

1. **개발자 옵션 활성화**
   - 설정 앱 열기
   - "휴대전화 정보" 또는 "디바이스 정보" 선택
   - "빌드 번호"를 **7번 연속 탭**
   - "개발자가 되셨습니다" 메시지 확인

2. **USB 디버깅 켜기**
   - 설정 > 개발자 옵션 (새로 생긴 메뉴)
   - "USB 디버깅" 활성화

3. **USB 케이블로 PC와 연결**
   - 데이터 전송이 가능한 케이블 사용 (충전 전용 케이블은 안 됨)
   - 폰에 "USB 디버깅 허용" 팝업이 뜨면 **허용** 선택
   - "이 컴퓨터에서 항상 허용" 체크하면 다음부터 안 물어봄

---

## 2. 빌드하기

### 2.1 프로젝트 폴더로 이동

VSCode 터미널 또는 PowerShell에서:

```powershell
cd D:\00_Study\FitLog
```

### 2.2 빌드 명령어 실행

```powershell
# Windows에서는 gradlew.bat 사용
.\gradlew.bat assembleDebug
```

**첫 빌드 시 주의사항:**
- 처음 빌드할 때는 라이브러리 다운로드로 인해 오래 걸림 (5~15분)
- 인터넷 연결 필요
- "BUILD SUCCESSFUL" 메시지가 나오면 성공

**빌드 결과물 위치:**
```
app/build/outputs/apk/debug/app-debug.apk
```

---

## 3. 폰에 설치하기

### 3.1 방법 1: Gradle로 자동 설치 (권장)

폰이 USB로 연결된 상태에서:

```powershell
.\gradlew.bat installDebug
```

이 명령어는 빌드 + 설치를 한 번에 해줍니다.

### 3.2 방법 2: ADB로 직접 설치

```powershell
# 먼저 연결된 기기 확인
adb devices

# 결과 예시:
# List of devices attached
# XXXXXXXX    device    <- 이렇게 나오면 연결 성공

# APK 설치
adb install app/build/outputs/apk/debug/app-debug.apk
```

### 3.3 방법 3: APK 파일 직접 복사

1. `app/build/outputs/apk/debug/app-debug.apk` 파일을 폰으로 복사
2. 폰의 파일 관리자 앱에서 APK 파일 찾기
3. 탭해서 설치 (출처를 알 수 없는 앱 설치 허용 필요)

---

## 4. 자주 발생하는 문제 해결

### 4.1 "adb devices"에서 기기가 안 보일 때

```powershell
# ADB 서버 재시작
adb kill-server
adb start-server
adb devices
```

그래도 안 보이면:
- USB 케이블 교체 (데이터 전송 가능한 케이블인지 확인)
- 폰에서 USB 연결 모드를 "파일 전송(MTP)"으로 변경
- 폰에서 USB 디버깅 다시 활성화

### 4.2 gradlew.bat을 찾을 수 없을 때

```
.\gradlew.bat : '.\gradlew.bat' 용어가 cmdlet, 함수, 스크립트 파일 또는
실행할 수 있는 프로그램 이름으로 인식되지 않습니다.
```

Gradle Wrapper 파일이 누락된 경우입니다.
`scripts/create_icons.ps1`과 함께 Gradle Wrapper 파일을 복구해야 합니다.

**필요한 파일:**
- `gradlew.bat` (Windows용)
- `gradlew` (Unix/Mac용)
- `gradle/wrapper/gradle-wrapper.jar`
- `gradle/wrapper/gradle-wrapper.properties`

### 4.3 빌드 실패 시

```powershell
# 캐시 삭제 후 다시 빌드
.\gradlew.bat clean
.\gradlew.bat assembleDebug
```

### 4.4 "INSTALL_FAILED_UPDATE_INCOMPATIBLE" 에러

이전 버전 앱이 설치되어 있어서 발생:

```powershell
# 기존 앱 삭제 후 재설치
adb uninstall com.fitlog
.\gradlew.bat installDebug
```

### 4.5 "No connected devices" 에러

```powershell
# 기기 연결 상태 확인
adb devices

# unauthorized가 뜨면 폰에서 USB 디버깅 허용 팝업 확인
```

---

## 5. 개발 워크플로우 (코드 수정 → 테스트)

코드를 수정한 후 테스트하는 순서:

```powershell
# 1. 빌드 + 설치 (한 줄로)
.\gradlew.bat installDebug

# 2. 앱 실행 (선택사항 - 폰에서 직접 앱을 열어도 됨)
adb shell am start -n com.fitlog/.MainActivity
```

### 빠른 테스트를 위한 팁

VSCode 터미널에서 위 명령어를 자주 사용하게 됩니다.
**위 화살표(↑)** 키를 누르면 이전 명령어를 불러올 수 있어요.

---

## 6. 로그 확인하기 (문제 발생 시)

앱이 크래시되거나 이상하게 동작할 때 로그를 확인합니다:

```powershell
# 실시간 로그 보기 (앱 관련 로그만 필터링)
adb logcat | findstr "fitlog"

# 또는 에러 로그만 보기
adb logcat *:E | findstr "fitlog"
```

**Ctrl + C**로 로그 보기를 중단할 수 있습니다.

---

## 7. 빠른 명령어 요약

| 목적 | 명령어 |
|------|--------|
| 빌드만 | `.\gradlew.bat assembleDebug` |
| 빌드 + 설치 | `.\gradlew.bat installDebug` |
| 기기 확인 | `adb devices` |
| 앱 삭제 | `adb uninstall com.fitlog` |
| 캐시 정리 | `.\gradlew.bat clean` |
| 로그 보기 | `adb logcat \| findstr "fitlog"` |

---

## 8. 체크리스트

앱 테스트 전 확인사항:

- [ ] 폰 개발자 옵션 활성화됨
- [ ] USB 디버깅 켜짐
- [ ] USB 케이블로 PC와 폰 연결됨
- [ ] `adb devices`에서 기기가 보임
- [ ] 빌드 성공 (BUILD SUCCESSFUL)

---

## 9. 무선 디버깅 (선택사항)

USB 케이블 없이 Wi-Fi로 테스트하는 방법:

### Android 11 이상

1. **폰 설정**
   - 설정 > 개발자 옵션 > 무선 디버깅 활성화
   - "페어링 코드로 기기 페어링" 선택
   - IP 주소와 페어링 코드 확인

2. **PC에서 연결**
   ```powershell
   # 페어링 (한 번만)
   adb pair 192.168.x.x:포트번호
   # 페어링 코드 입력

   # 연결
   adb connect 192.168.x.x:포트번호
   ```

3. 이후 `.\gradlew.bat installDebug` 사용 가능

**주의:** PC와 폰이 같은 Wi-Fi에 연결되어 있어야 합니다.
