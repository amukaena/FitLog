# FitLog - 개발 진행 기록

## 최종 수정일: 2026-01-30

---

## 개발 이력

| 날짜 | 내용 |
|------|------|
| 2026-01-29 | Phase 1~6 개발 완료 |
| 2026-01-30 | 빌드 환경 수정 (Gradle Wrapper 복구, 앱 아이콘 생성, 코드 오류 수정) |
| 2026-01-30 | 2차 개발: 드래그 앤 드롭, 홈 화면 위젯, Google Drive 백업 기능 구현 |

---

## 1. Phase 1: 프로젝트 초기 설정 ✅

### 완료된 작업
- 프로젝트 폴더 구조 생성
- 테마 시스템 구현 (다크 모드 전용, 녹색 포인트 컬러)
- 네비게이션 구조 설정

### 생성된 파일
```
presentation/
├── theme/
│   ├── Color.kt          # 컬러 팔레트 정의
│   ├── Theme.kt          # Material3 다크 테마 설정
│   └── Type.kt           # 타이포그래피 설정
└── navigation/
    ├── Screen.kt         # 화면 라우트 정의
    └── NavGraph.kt       # 네비게이션 그래프
```

---

## 2. Phase 2: 데이터 레이어 ✅

### 완료된 작업
- Room 데이터베이스 설정
- Entity 클래스 생성 (Exercise, DailyWorkout, WorkoutRecord, WorkoutSet)
- DAO 인터페이스 구현
- Repository 패턴 구현
- Domain 모델 정의
- Entity-Domain 매퍼 구현
- Hilt DI 모듈 설정
- 기본 운동 데이터 초기화 로직 구현

### 생성된 파일
```
data/
├── local/
│   ├── FitLogDatabase.kt
│   ├── dao/
│   │   ├── ExerciseDao.kt
│   │   ├── DailyWorkoutDao.kt
│   │   ├── WorkoutRecordDao.kt
│   │   └── WorkoutSetDao.kt
│   └── entity/
│       ├── ExerciseEntity.kt
│       ├── DailyWorkoutEntity.kt
│       ├── WorkoutRecordEntity.kt
│       ├── WorkoutSetEntity.kt
│       └── EntityMappers.kt
└── repository/
    ├── ExerciseRepositoryImpl.kt
    └── WorkoutRepositoryImpl.kt

domain/
├── model/
│   ├── Exercise.kt
│   ├── DailyWorkout.kt
│   ├── WorkoutRecord.kt
│   └── WorkoutSet.kt
└── repository/
    ├── ExerciseRepository.kt
    └── WorkoutRepository.kt

di/
├── AppModule.kt          # Database, DAO 제공
└── RepositoryModule.kt   # Repository 바인딩

util/
└── DateUtils.kt          # 날짜 유틸리티 함수
```

### 기본 운동 데이터
- 가슴: 벤치프레스, 인클라인 벤치프레스, 덤벨 플라이, 케이블 크로스오버, 푸시업
- 등: 데드리프트, 랫풀다운, 바벨로우, 시티드로우, 풀업
- 어깨: 오버헤드프레스, 사이드 레터럴 레이즈, 프론트 레이즈, 페이스풀
- 팔: 바벨컬, 덤벨컬, 트라이셉스 익스텐션, 케이블 푸시다운, 해머컬
- 하체: 스쿼트, 레그프레스, 레그익스텐션, 레그컬, 런지, 카프레이즈
- 코어: 플랭크, 크런치, 레그레이즈, 러시안 트위스트

---

## 3. Phase 3: 캘린더 화면 ✅

### 완료된 작업
- 월간 캘린더 UI 구현
- 월 이동 기능 (이전/다음 버튼)
- 날짜 선택 기능
- 운동 기록 마커 표시 (녹색 점)
- 오늘 날짜 강조 표시
- 선택된 날짜의 운동 목록 표시

### 생성된 파일
```
presentation/calendar/
├── CalendarScreen.kt     # 메인 캘린더 화면
└── CalendarViewModel.kt  # 캘린더 상태 관리
```

### 주요 기능
- 월간 캘린더 그리드 렌더링
- 선택된 날짜 하이라이트 (녹색 배경)
- 운동 기록이 있는 날짜에 마커 표시
- 하단에 선택된 날짜의 운동 요약 카드 표시

---

## 4. Phase 4: 운동 기록 기능 ✅

### 완료된 작업
- 일일 운동 기록 화면 구현
- 운동 선택 바텀시트 (카테고리 필터, 검색)
- 세트 편집 화면 구현
- 이전 기록 복사 기능
- 운동 추가/삭제 기능
- 세트 추가/삭제/수정 기능

### 생성된 파일
```
presentation/workout/
├── DailyWorkoutScreen.kt    # 일일 운동 기록 화면
├── WorkoutViewModel.kt      # 운동 기록 상태 관리
├── WorkoutSetEditScreen.kt  # 세트 편집 화면
└── WorkoutSetViewModel.kt   # 세트 편집 상태 관리

presentation/components/
├── ExerciseSelectBottomSheet.kt  # 운동 선택 바텀시트
└── CopyWorkoutBottomSheet.kt     # 이전 기록 복사 바텀시트
```

### 주요 기능
- 운동 제목/메모 입력
- 운동 종목 선택 (카테고리별 필터링, 검색)
- 세트별 무게/횟수 입력
- 이전 날짜 기록 복사 (타이틀, 운동, 세트 정보 모두 복사)

---

## 5. Phase 5: 운동 관리 ✅

### 완료된 작업
- 운동 목록 관리 화면 구현
- 카테고리별 필터링
- 최근 사용순 정렬
- 커스텀 운동 추가 기능

### 생성된 파일
```
presentation/exercise/
├── ExerciseManageScreen.kt  # 운동 목록 관리 화면
└── ExerciseViewModel.kt     # 운동 관리 상태 관리
```

### 주요 기능
- 전체/카테고리별 운동 목록 표시
- 최근 사용한 운동 상단 표시
- 새 운동 추가 다이얼로그

---

## 6. Phase 6: 설정 및 백업 ✅

### 완료된 작업
- 설정 화면 구현
- JSON 파일 내보내기 기능
- JSON 파일 가져오기 기능
- Google Drive 백업 화면 (UI만, 기능은 추후 구현 예정)

### 생성된 파일
```
presentation/settings/
├── SettingsScreen.kt           # 설정 화면
├── SettingsViewModel.kt        # 설정/백업 상태 관리
└── GoogleDriveBackupScreen.kt  # Google Drive 백업 화면
```

### 백업 데이터 형식
```json
{
  "version": 1,
  "exportedAt": "2024-01-15T10:30:00",
  "exercises": [...],
  "dailyWorkouts": [...]
}
```

---

## 7. 프로젝트 구조 요약

```
app/src/main/java/com/fitlog/
├── FitLogApplication.kt
├── MainActivity.kt
│
├── data/
│   ├── local/
│   │   ├── FitLogDatabase.kt
│   │   ├── dao/ (4개 DAO)
│   │   └── entity/ (4개 Entity + Mappers)
│   └── repository/ (2개 구현체)
│
├── domain/
│   ├── model/ (4개 도메인 모델)
│   └── repository/ (2개 인터페이스)
│
├── presentation/
│   ├── theme/ (Color, Theme, Type)
│   ├── navigation/ (Screen, NavGraph)
│   ├── calendar/ (Screen, ViewModel)
│   ├── workout/ (2개 Screen, 2개 ViewModel)
│   ├── exercise/ (Screen, ViewModel)
│   ├── settings/ (2개 Screen, ViewModel)
│   └── components/ (2개 BottomSheet)
│
├── di/ (AppModule, RepositoryModule)
│
└── util/ (DateUtils)
```

---

## 8. 빌드 환경 수정 (2026-01-30)

### 8.1 Gradle Wrapper 복구

프로젝트에서 누락된 Gradle Wrapper 파일들을 생성했습니다.

**생성된 파일:**
```
gradlew.bat          # Windows용 Gradle 실행 스크립트
gradlew              # Unix/Mac용 Gradle 실행 스크립트
gradle/wrapper/
└── gradle-wrapper.jar  # Gradle Wrapper JAR (Gradle 8.5)
```

### 8.2 앱 아이콘 리소스 생성

누락된 앱 런처 아이콘을 생성했습니다.

**생성된 파일:**
```
app/src/main/res/
├── drawable/
│   └── ic_launcher_foreground.xml  # 벡터 아이콘 (흰색 F 로고)
├── mipmap-anydpi-v26/
│   ├── ic_launcher.xml             # Adaptive Icon 정의
│   └── ic_launcher_round.xml
├── mipmap-mdpi/
│   ├── ic_launcher.png             # 48x48
│   └── ic_launcher_round.png
├── mipmap-hdpi/
│   ├── ic_launcher.png             # 72x72
│   └── ic_launcher_round.png
├── mipmap-xhdpi/
│   ├── ic_launcher.png             # 96x96
│   └── ic_launcher_round.png
├── mipmap-xxhdpi/
│   ├── ic_launcher.png             # 144x144
│   └── ic_launcher_round.png
├── mipmap-xxxhdpi/
│   ├── ic_launcher.png             # 192x192
│   └── ic_launcher_round.png
└── values/
    └── colors.xml                  # ic_launcher_background 색상 (#4CAF50)
```

### 8.3 코드 오류 수정

**ExerciseManageScreen.kt:**
- `MenuAnchorType.PrimaryNotEditable` → `.menuAnchor()` 변경
- Material3 버전 호환성 문제 해결

**DailyWorkoutScreen.kt:**
- `Icons.Default.ContentCopy` 사용을 위해 `material-icons-extended` 라이브러리 추가

### 8.4 build.gradle.kts 수정

```kotlin
// 추가된 의존성
implementation("androidx.compose.material:material-icons-extended")

// 추가된 패키징 옵션 (Google Drive API 충돌 해결)
packaging {
    resources {
        excludes += "/META-INF/{AL2.0,LGPL2.1}"
        excludes += "/META-INF/DEPENDENCIES"
        excludes += "/META-INF/LICENSE"
        excludes += "/META-INF/LICENSE.txt"
        excludes += "/META-INF/NOTICE"
        excludes += "/META-INF/NOTICE.txt"
    }
}
```

---

## 9. 2차 개발 (2026-01-30) ✅

### 9.1 드래그 앤 드롭 (운동 순서 변경)

운동 목록에서 롱프레스하여 순서를 변경할 수 있는 기능을 구현했습니다.

**사용 라이브러리:**
- `sh.calvin.reorderable:reorderable:2.3.0`

**수정된 파일:**
```
app/build.gradle.kts              # reorderable 의존성 추가
WorkoutViewModel.kt               # moveRecord() 함수 추가, debounce 적용
DailyWorkoutScreen.kt             # ReorderableLazyColumn, 드래그 핸들 UI
```

**주요 기능:**
- 운동 카드 좌측에 드래그 핸들(≡) 아이콘
- 롱프레스로 드래그 시작
- 드래그 중 카드에 그림자 효과
- 순서 변경 시 DB 자동 저장 (debounce 300ms)

### 9.2 홈 화면 위젯 (Glance)

2주간 운동 기록을 보여주는 홈 화면 위젯을 구현했습니다.

**생성된 파일:**
```
widget/
├── FitLogWidget.kt          # GlanceAppWidget 메인 클래스
├── FitLogWidgetReceiver.kt  # BroadcastReceiver
└── FitLogWidgetContent.kt   # Glance UI 컴포저블

res/xml/widget_info.xml      # 위젯 메타데이터
res/layout/widget_loading.xml # 초기 로딩 레이아웃
```

**수정된 파일:**
```
AndroidManifest.xml          # 위젯 receiver 등록
strings.xml                  # 위젯 설명 문자열
FitLogDatabase.kt            # getDatabase() 싱글톤 패턴 추가
DailyWorkoutDao.kt           # getWorkoutDatesInRangeSync() 함수 추가
```

**주요 기능:**
- 4x2 크기의 홈 화면 위젯
- 2주간 캘린더 그리드 (7일 x 2줄)
- 운동한 날: 녹색, 오늘: 밝은 녹색
- 운동 일수 카운터 (예: 8/14일)
- 위젯 클릭 시 앱 실행
- 1시간마다 자동 업데이트

### 9.3 Google Drive 백업

Google OAuth 연동 및 Google Drive 백업/복원 기능을 구현했습니다.

**생성된 파일:**
```
data/remote/
├── GoogleAuthManager.kt     # Google Sign-In 관리
└── GoogleDriveManager.kt    # Drive API 래퍼

presentation/settings/
└── GoogleDriveViewModel.kt  # Drive 백업 ViewModel

docs/
└── 09_Google_Drive_설정_가이드.md  # 설정 안내 문서
```

**수정된 파일:**
```
GoogleDriveBackupScreen.kt   # UI 전면 재작성 (활성화)
```

**주요 기능:**
- Google 계정 로그인/로그아웃
- 로그인 상태 유지
- Google Drive에 백업 파일 업로드
- 백업에서 복원 (복원 전 확인 다이얼로그)
- 마지막 백업 시간 표시
- 진행 상태 표시 (스피너)
- 에러 처리 및 스낵바 메시지

**참고:**
- Google Drive 백업 기능을 사용하려면 Google Cloud Console 설정이 필요합니다
- 자세한 내용은 `docs/09_Google_Drive_설정_가이드.md` 참조

---

## 10. 완료된 기능 요약

### 1차 개발 (Phase 1~6)
- [x] 캘린더 화면 (월간 캘린더, 마커, 날짜 선택)
- [x] 일일 운동 기록 (운동 추가, 제목/메모 입력)
- [x] 세트 편집 (세트 추가/삭제, 무게/횟수 입력)
- [x] 운동 관리 (카테고리별 필터링, 커스텀 운동 추가)
- [x] 설정 화면 (JSON 내보내기/가져오기)
- [x] 복사 기능 (이전 기록 복사)

### 2차 개발
- [x] 드래그 앤 드롭 운동 순서 변경
- [x] 홈 화면 위젯 (2주간 운동 기록)
- [x] Google Drive OAuth 연동
- [x] Google Drive 백업/복원

---

## 11. 미구현 기능 (추후 개발 예정)

- [ ] UI 개선 및 애니메이션
- [ ] 운동 통계 화면
- [ ] 알림 기능

---

## 12. 빌드 및 실행 방법

```powershell
# 프로젝트 루트에서
./gradlew assembleDebug

# APK 설치 (USB 디버깅 활성화된 기기 연결 필요)
./gradlew installDebug
```

---

## 13. 기술 스택 요약

| 구분 | 기술 |
|------|------|
| 언어 | Kotlin |
| UI | Jetpack Compose + Material3 |
| 아키텍처 | MVVM + Clean Architecture |
| 로컬 DB | Room |
| 의존성 주입 | Hilt |
| 비동기 처리 | Kotlin Coroutines + Flow |
| 네비게이션 | Navigation Compose |
| 위젯 | Jetpack Glance |
| 드래그 앤 드롭 | sh.calvin.reorderable |
| 백업 | JSON (Gson), Google Drive API |
| 인증 | Google Play Services Auth |
